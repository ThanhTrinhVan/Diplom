%Моделирование функций принадлежности и дигностики болезней
%с использованием параметров функций GLCM и метрики в виде коэффициента
%корреляции параметров в столбцах матрицы обучения  и  центров распределения 
%24-х параметров Харалика 10-ми целевых изображений. 
%Матрица обучения содержит 8 столбцов по количеству распознаваемых
%болезней,в i-том столбце содежатся центры распределений значений параметров
%Харалика для массива всех изображений, соответствующих i-той болезни.


clc;
clear;

%m=1000;%количество статистических испытаний. 
m=1;
k=8;%номер заболевания на входе
%contr=8; %контрольная точка для настройки программы
kb_in=2^k;%входной код заболевания (нужен для определения правильности диагностики)
S=0.06;%СКО случайных отклонений от эталонных значений
BT=0.005;%коэффициент для порога бинаризации
x = 0:14;%номера возможных болезней

%Подлинные результаты измерений параметров Contrast, Correlation,
%Energy,Homogenity для компонент R,G,B,RG,RB,GB (Считаем их эталонными описаниями для 15
%болезней). Вместо этого массива данных нужно
%использовать массив значений, усредненных по обучающей выборке
% Rcon = [0.2457 0.124 0.3154 0.2008 0.3102 0.2077 0.2023 0.1599 0.2013 0.2941 0.3151 0.1268 0.2207 0.33 0.34];
% Rcor = [0.9497 0.9439 0.8911 0.8028 0.8128 0.9657 0.937 0.9296 0.8735 0.8784 0.8542 0.9341 0.9049 0.8213 0.935];
% Ren = [0.1195 0.2224 0.1504 0.3312 0.1897 0.1092 0.2122 0.2347 0.2263 0.1417 0.1444 0.2764 0.1639 0.1693 0.1583];
% Rhom = [0.9005 0.9471 0.8596 0.925 0.8669 0.9064 0.9062 0.923 0.9024 0.8653 0.8514 0.938 0.8938 0.8495 0.9026];
% Gcon = [0.2055	0.1204	0.2809	0.2413	0.3021	0.1782	0.2229	0.1494	0.226	0.241	0.2542	0.1181	0.2591	0.367	0.1953];
% Gcor = [0.9126	0.9436	0.8666	0.7935	0.8201	0.9628	0.9378	0.9377	0.9062	0.862	0.8593	0.942	0.7696	0.8382	0.9441];
% Gen = [0.1816	0.2485	0.2108	0.2585	0.1797	0.132	0.1415	0.298	0.1651	0.1827	0.1731	0.3011	0.2667	0.1998	0.146];
% Ghom = [0.9154	0.9477	0.8758	0.9046	0.8637	0.9188	0.8949	0.9281	0.8911	0.885	0.8766	0.9424	0.8872	0.8706	0.9064];
% Bcon = [0.221	0.1095	0.3115	0.2527	0.313	0.1799	0.1791	0.1634	0.2008	0.2449	0.3155	0.0996	0.2928	0.408	0.1915];
% Bcor = [0.9418	0.9412	0.8015	0.7478	0.8167	0.96	0.8436	0.96	0.8756	0.8239	0.8599	0.9651	0.8327	0.7752	0.9501];
% Ben = [0.143	0.2467	0.2115	0.3014	0.1764	0.1765	0.36	0.3596	0.4416	0.2292	0.1689	0.5066	0.1982	0.2018	0.1538];
% Bhom = [0.9115	0.9553	0.8613	0.9102	0.8541	0.917	0.9133	0.9206	0.9023	0.8832	0.8515	0.9514	0.8715	0.8596	0.9075];
% RGcon = [0.0325	0.0272	0.0068	0.0716	0.2173	0.0436	0.0047	0.0353	0.022	0	0.2309	0.0141	0.1669	0	0.1915];
% RGcor = [0.9443	0.8913	0.7202	0.8351	0.7942	0.8913	0.7728	0.9363	0.901	0	0.6877	0.8054	0.7707	0	0.9501];
% RGen = [0.7012	0.7232	0.9689	0.5689	0.2338	0.6744	0.9748	0.4623	0.7886	1	0.3307	0.9136	0.3319	1	0.1538];
% RGhom = [0.9838	0.9864	0.9966	0.9642	0.8922	0.9782	0.9977	0.9823	0.989	1	0.8854	0.9929	0.9178	1	0.9075];
% RBcon = [0.1206	0.0796	0.0778	0.1414	0.4523	0.1227	0.0939	0.1122	0.1004	0.1579	0.4487	0.0494	0.2209	0.0353	0.0053];
% RBcor = [0.9804	0.9222	0.8669	0.9139	0.7994	0.954	0.9383	0.9468	0.9186	0.8088	0.8683	0.9505	0.8746	0.8215	0.7371];
% RBen = [0.2187	0.3535	0.5046	0.2234	0.1276	0.2023	0.3236	0.2454	0.313	0.3227	0.0914	0.3914	0.2045	0.8055	0.9747];
% RBhom = [0.9401	0.9602	0.9611	0.9305	0.8144	0.9388	0.9532	0.9439	0.9532	0.9212	0.7974	0.9753	0.8919	0.9823	0.9974];
% GBcon = [0.1205	0.0626	0.0764	0.0842	0.3176	0.0818	0.1041	0.1037	0.1425	0.1464	0.1746	0.0578	0.1258	0.0385	0.0535];
% GBcor = [0.964	0.9218	0.8665	0.8384	0.7138	0.9187	0.9267	0.9192	0.9289	0.7705	0.794	0.9458	0.812	0.7731	0.8965];
% GBen = [0.1983	0.3974	0.4506	0.4231	0.2515	0.3384	0.2669	0.3425	0.2186	0.4016	0.3142	0.3648	0.4018	0.8044	0.4677];
% GBhom = [0.94	0.9687	0.9618	0.9583	0.8518	0.9591	0.9484	0.9482	0.9343	0.9269	0.9127	0.9711	0.9371	0.9807	0.9733];

%Эталонные описания. Вариант2
% Rcon=[0.2952	0.1468	0.6683	0.2377	0.7554	0.2935	0.4243	0.2211	0.5882	0.3389	0.4601	0.1577	0.4222	0.5914	0.2519];
% Rcor=[0.9322	0.9227	0.762	0.7828	0.6414	0.9459	0.8763	0.882	0.658	0.8578	0.7947	0.8512	0.8047	0.777	0.8934];
% Ren=[0.1201	0.2185	0.1046	0.2853	0.1253	0.0965	0.1429	0.207	0.1231	0.1309	0.1165	0.2965	0.1339	0.1363	0.1656];
% Rhom=[0.8786	0.9272	0.7635	0.9047	0.7665	0.8695	0.8192	0.8926	0.7616	0.8437	0.7979	0.9212	0.8208	0.8048	0.8793];
% Gcon=[0.2641	0.1409	0.6492	0.2764	0.7484	0.2625	0.4357	0.2054	0.6061	0.3082	0.4183	0.1592	0.4813	0.5143	0.2412];
% Gcor=[0.862	0.9186	0.6842	0.7669	0.6466	0.9305	0.8573	0.8809	0.7658	0.8277	0.774	0.8577	0.699	0.7629	0.9168];
% Gen=[0.1886	0.2593	0.1385	0.2385	0.1117	0.123	0.1076	0.2749	0.0973	0.1604	0.1357	0.3021	0.1987	0.1719	0.1433];
% Ghom=[0.89	0.93	0.7715	0.8864	0.7601	0.8805	0.8136	0.9008	0.759	0.8543	0.8146	0.9206	0.8162	0.8277	0.8847];
% Bcon=[0.2647	0.1326	0.6532	0.2651	0.6756	0.2662	0.4168	0.2241	0.5705	0.2977	0.4796	0.1285	0.5006	0.5422	0.2485];
% Bcor=[0.9189	0.9185	0.6187	0.7008	0.6134	0.907	0.6859	0.8789	0.3845	0.8024	0.7617	0.7951	0.7689	0.6947	0.9051];
% Ben=[0.1458	0.2349	0.1393	0.2939	0.122	0.1864	0.2175	0.3354	0.2052	0.2006	0.1355	0.5361	0.1307	0.1677	0.1589];
% Bhom=[0.8895	0.9342	0.7661	0.8982	0.7608	0.8782	0.8195	0.8893	0.7641	0.8595	0.792	0.9359	0.8077	0.8166	0.8804];
% RGcon=[0.0309	0.0252	0.0061	0.0704	0.1667	0.0501	0.0054	0.0368	0.023	0.0003	0.2192	0.0133	0.152	0	0.0015];
% RGcor=[0.9468	0.9007	0.7206	0.8331	0.8098	0.8924	0.769	0.9329	0.902	-0.0001	0.6811	0.7481	0.7469	0	0.3993];
% RGen=[0.7041	0.7221	0.9719	0.5671	0.2946	0.6123	0.9714	0.4589	0.7769	0.9994	0.3123	0.9341	0.3884	1	0.996];
% RGhom=[0.9845	0.9874	0.9969	0.9648	0.9167	0.975	0.9973	0.9816	0.9885	0.9999	0.8904	0.9934	0.924	1	0.9993];
% RBcon=[0.1108	0.0758	0.075	0.1239	0.2903	0.1188	0.0768	0.1093	0.0824	0.1229	0.3924	0.0394	0.1991	0.0424	0.0463];
% RBcor=[0.9777	0.9192	0.8549	0.9197	0.8319	0.9569	0.9565	0.9304	0.9073	0.8059	0.8522	0.9309	0.8381	0.8257	0.8237];
% RBen=[0.212	0.3658	0.5378	0.2389	0.1794	0.1868	0.3135	0.2661	0.3504	0.4236	0.1098	0.4717	0.2699	0.7587	0.6944];
% RBhom=[0.9449	0.9621	0.9625	0.9381	0.8646	0.9406	0.9616	0.9454	0.9588	0.9386	0.812	0.9803	0.9007	0.9788	0.9769];
% GBcon=[0.1058	0.0576	0.0735	0.075	0.233	0.0788	0.0847	0.0998	0.1203	0.1096	0.1612	0.0606	0.1135	0.0223	0.06];
% GBcor=[0.9554	0.9169	0.8509	0.853	0.7588	0.9181	0.929	0.8908	0.9252	0.7635	0.7715	0.9252	0.8079	0.7192	0.8603];
% GBen=[0.2263	0.4219	0.4966	0.4304	0.3154	0.3529	0.3109	0.3953	0.2428	0.5007	0.3678	0.3834	0.4565	0.8994	0.532];
% GBhom=[0.9472	0.9712	0.9633	0.9625	0.8867	0.9606	0.9577	0.9501	0.9398	0.9452	0.9194	0.9697	0.9432	0.9888	0.97];

% Variant 3 Learning matrix 07.02.2020, v2
% Rcon=[0.005966  0.004241  0.006959  0.004104  0.00389  0.005666  0.004819  0.005094];
% Rcor=[0.90763  0.9546  0.9546  0.9717  0.975  0.9481  0.9690  0.947];
% Ren=[0.2135  0.24044  0.13215  0.18206  0.1581  0.2403  0.1656  0.1787];
% Rhom=[0.8694  0.90616  0.85618  0.919168  0.914459  0.8899  0.897596  0.88257];
% Rentr=[0.846806  0.83113  1.042937  0.8915  0.94267  0.8818696  0.955458  0.92227];
% Ridm=[0.868  0.90544  0.853879  0.9183  0.913979  0.888  0.89669687  0.88207];
% Gcon=[0.00588  0.004346  0.00636  0.004047  0.00356898  0.005503675  0.0049  0.0046];
% Gcor=[0.9125  0.9689  0.9469  0.9537  0.9545  0.964499  0.9647657  0.92529];
% Gen=[0.206097  0.22717  0.157  0.257  0.2319  0.239555  0.176095  0.2272];
% Ghom=[0.86904  0.906108  0.866  0.9208  0.9217  0.8943  0.8947  0.89249];
% Gentr=[0.873209  0.87318 0.9674877  0.78289  0.7947   0.893126  0.95193  0.825071];
% Gidm=[0.86781  0.9053  0.86414  0.9199  0.921217  0.89252  0.89385  0.892356];
% Bcon=[0.00568  0.0035067  0.006908  0.003439  0.00329398  0.00543  0.004697  0.00431];
% Bcor=[0.91045  0.94139  0.936987  0.9337  0.9512  0.9484   0.95427  0.9173];
% Ben=[0.1956  0.32862  0.155  0.323  0.2984  0.2617  0.19031  0.2633975];
% Bhom=[0.871304  0.91929  0.85718  0.9268  0.9275  0.8941  0.89488  0.8975];
% Bentr=[0.87108  0.68154  0.987069  0.687867  0.712436  0.84677  0.907345  0.77791];
% Bidm=[0.870303 0.918870 0.85580 0.926257 0.92710 0.89273 0.8941 0.89730];
% RGcon=[0.0017597  0.0003784  0.00000853  0.00029813  0.00070  0.0000102  0.000168  0.00148];
% RGcor=[0.9325  0.93603  0.93639  0.93397  0.96705  0.8816585  0.9566243  0.87860];
% RGen=[0.453024  0.82375  0.99853  0.8539  0.57090  0.998635  0.9368956  0.6062];
% RGhom=[0.957060  0.99078  0.99978  0.99269  0.98282  0.999749  0.99586  0.963659];
% RGentr=[0.47153  0.154842  0.002452  0.1326  0.34821  0.00238  0.0566  0.33684];
% RGidm=[0.95704  0.99078 0.99978  0.99269  0.98282  0.999749  0.9958618  0.96365];
% RBcon=[0.003237  0.001353  0.002018  0.002031  0.00199  0.0011479  0.001418  0.003748];
% RBcor=[0.9524  0.94909  0.917776  0.97494  0.983624  0.925977  0.95924  0.94901];
% RBen=[0.22106  0.456492  0.464776  0.277428  0.216514  0.635735  0.3623273  0.22839];
% RBhom=[0.921854  0.96806  0.951069  0.952352  0.9514485  0.97220  0.9657989  0.90991];
% RBentr=[0.7779  0.49191  0.46625  0.70684  0.79461178  0.31704  0.570488  0.79942];
% RBidm=[0.921738  0.967991  0.9510165  0.9523475  0.951426  0.972178  0.96576  0.909753];
% GBcon=[0.00189  0.0013238  0.00222384  0.0017519  0.001758665  0.0011756  0.0014961  0.002257];
% GBcor=[0.8915  0.96485  0.9079  0.9538  0.9696  0.9549  0.94122  0.89943];
% GBen=[0.52253  0.4239  0.45656  0.37917  0.314299  0.4879  0.45045  0.466300];
% GBhom=[0.9535   0.968099   0.94556   0.958255   0.957025   0.9713   0.96398   0.944888];
% GBentr=[0.413621  0.5112865  0.472284  0.57557  0.65957  0.432077  0.490625  0.498020];
% GBidm=[0.95350  0.96805  0.945561  0.9582 0.9570  0.9713  0.9639  0.9448];
% 
%Формат матрицы Обучение 08.02.2020, v3
Rcon=[0.007784 0.0037 0.0072131 0.003198 0.0044638 0.00544 0.00409173 0.00505];
Rcor=[ 0.873222 0.9605259 0.957989 0.9722733 0.88011365 0.95338347 0.9676588 0.948455];
Ren=[ 0.19620 0.24327 0.1294125 0.2235858 0.19041209 0.19791345 0.1973892 0.1780044];
Rhom =[0.8406052 0.91536 0.855750 0.9338817 0.8294516 0.884681 0.9137986 0.8845595];
Rentr=[0.888262 0.8187 1.05928 0.82640654 0.80913646 0.931664 0.8816244 0.922222];
Ridm=[0.8381825 0.9149398 0.8531575 0.9333581 0.82846 0.8833289 0.91304205 0.883052];
Gcon=[0.0079739 0.00387 0.0065955 0.00321208 0.0044039 0.0052765 0.00414617 0.004577];
Gcor=[0.88831 0.9702918 0.949321 0.9535231 0.8647355 0.96443765 0.9638027 0.925638];
Gen=[0.17540 0.227819 0.1523514 0.2898504 0.2062121 0.19785925 0.2090159 0.22288];
Ghom=[0.836998 0.91315928 0.8642454 0.9347875 0.830586 0.888765 0.91255465 0.892494];
Gentr =[0.926165 0.861888 0.98453785 0.717544 0.7611946 0.9405227 0.8648685 0.8271635];
Gidm =[0.83420 0.91258356 0.8621433 0.9342277 0.8295575 0.887368 0.91179765 0.892269];
Bcon =[0.00738 0.0031128 0.007039 0.00262047 0.0043102 0.00516357 0.00379513 0.0043323];
Bcor =[0.86086 0.9470187 0.94139244 0.9388330 0.85046577 0.9505124 0.9511281 0.9137944];
Ben =[0.19336 0.3296812 0.1502354 0.400077 0.237275 0.217533 0.234824359 0.263349];
Bhom =[0.842812 0.92711928 0.8566517 0.94302879 0.831506 0.8895034 0.91400945 0.89739];
Bentr =[0.8696849 0.6879141 1.0031490 0.6027447 0.709604 0.88746047 0.790769375 0.7729292];
Bidm =[0.840728 0.9268271 0.853907 0.94263379 0.830622 0.888417 0.91343635 0.89708];
RGcon =[0.0026089 0.00031168 0.0000065 0.00025227 0.0009419 0.000006 0.000107177 0.00156177];
RGcor =[0.903677 0.945114 0.953136 0.93180208 0.87559658 0.940715 0.97101795 0.8895568];
RGen =[0.452899 0.84590 0.998920 0.8681397 0.4988333 0.999157 0.94651295 0.58221025];
RGhom =[0.93815 0.9924098 0.999841 0.9938192 0.8985446 0.9998529 0.99737415 0.961759];
RGentr =[0.4849855 0.131694 0.001807 0.11490569 0.343881 0.0014898 0.04691063 0.3497064];
RGidm =[0.937945 0.9924052 0.9998412 0.993819 0.89854 0.9998529 0.99737415 0.9617565];
RBcon =[0.0046307 0.00129190 0.001656 0.0017042 0.002382 0.00113787 0.00123839 0.00356809];
RBcor =[0.92641 0.9554232 0.910944 0.9719245 0.8843019 0.93242509 0.963005 0.9483888];
RBen =[0.21383 0.4420443 0.5381358 0.3172767 0.2690026 0.59178847 0.382579625 0.2264268];
RBhom =[0.8898327 0.9691969 0.95982 0.9595859 0.86721767 0.9722957 0.970296 0.914237258];
RBentr =[0.796811 0.50205728 0.40067238 0.6524796 0.6353009 0.3354265 0.539528125 0.79451929];
RBidm =[0.889305 0.96914753 0.95978389 0.95950775 0.867045 0.972281047 0.9702433 0.914080];
GBcon =[0.002957 0.0012268 0.001937 0.00148669 0.0021655 0.001096327 0.00125068 0.002220];
GBcor =[0.842868 0.9658291 0.912343 0.9512002 0.8565959 0.952211238 0.94675505 0.90592];
GBen =[0.458716 0.435539 0.481854 0.43147337 0.330545109 0.498997428 0.48657815 0.4412487];
GBhom =[0.9278188 0.970318 0.9529564 0.9643879 0.87111508 0.973174143 0.9700775 0.9458949];
GBentr =[0.4513 0.4961683 0.4424913 0.51402354 0.552937 0.41487413 0.439876 0.519392];
GBidm =[0.92779 0.970287 0.9529128 0.96431929 0.871046 0.97317 0.97001445 0.945867];



% Matrix test б7.02.2020, v3
    XRcon=[0.009731806 0.00264039125 0.007879397 0.0018801543 0.00614471 0.0053377618 0.0033128175 0.004833312];
    XRcor=[0.84533825 0.9734285 0.9672172 0.97363325 0.925468375 0.9603745 0.967619375 0.955795875];
    XRen=[0.1805616 0.250500125 0.112310525 0.258824 0.280398875 0.1420616875 0.223934625 0.1707815];
    XRhom=[0.8141191 0.936688625 0.8544462 0.9544806 0.8787907 0.8778888 0.9312032 0.8874436];
    XRentr=[0.9255728 0.788653375 1.130415 0.7489015 0.7796942 1.001393 0.79872875 0.924905625];
    XRidm=[0.8098541 0.9366115 0.8509921 0.9544277 0.8770152 0.8770571 0.9307712 0.8868592];
    XGcon=[0.00955844625 0.0029771625 0.00726695 0.00192884375 0.0063078775 0.0052074361 0.0033231745 0.004382277];
    XGcor=[0.863611125 0.975859 0.956802375 0.9557677 0.9134409 0.9654736 0.96628475 0.929899625];
    XGen=[0.1469025 0.22156525 0.13900204 0.3356107 0.2043135 0.145991875 0.23373275 0.2156865];
    XGhom=[0.809528 0.92805325 0.8588607 0.95340375 0.8708871 0.8815402 0.933294875 0.8953906];
    XGentr=[0.9728933 0.846445 1.0356882 0.6260552 0.8683705 1.010511125 0.77317375 0.839191125];
    XGidm=[0.805730125 0.92798725 0.8561527 0.953262125 0.8687899 0.8806687 0.932931125 0.8951189];
    XBcon=[0.0086972625 0.002297975 0.007406038 0.0013662523 0.006501245 0.0050583489 0.0028623476 0.0041827325];
    XBcor=[0.821758625 0.962851375 0.953229 0.958688875 0.8823348 0.9532005 0.9468696 0.907919625];
    XBen=[0.180319625 0.322359625 0.1337615 0.5060512 0.2047055 0.172057125 0.275907 0.25482725];
    XBhom=[0.8171696 0.943722 0.8567629 0.96797675 0.8649523 0.882290625 0.9337825 0.898977125];
    XBentr=[0.886415125 0.7031947 1.0513883 0.4835734 0.852852375 0.9327581 0.710512375 0.7670855];
    XBidm=[0.8141108 0.9437195 0.8538658 0.9676595 0.8634333 0.881942125 0.9335065 0.89883175];
    XRGcon=[0.003373305 0.0001287494625 0.0 0.00010041435 0.00140528625 0.0 0.00002 0.0015971255];
    XRGcor=[0.8752189 0.97027875 1.0 0.966420375 0.92761425 1.0 0.98643775 0.9173358];
    XRGen=[0.450874 0.9283335 1.0 0.914867375 0.4940078 1.0 0.988185375 0.523286625];
    XRGhom=[0.9211347 0.996845625 1.0 0.997539875 0.9656935 1.0 0.9993855 0.960870125];
    XRGentr=[0.5120832 0.055603075 0.0 0.0766149025 0.3971345 0.0 0.0135338625 0.3792981];
    XRGidm=[0.9207566 0.996845625 1.0 0.997539875 0.96568125 1.0 0.9993855 0.960870125];
    XRBcon=[0.006040132 0.0011566237 0.00063998111 0.0011794957 0.00309957625 0.001096563 0.001040694625 0.00312243];
    XRBcor=[0.901125625 0.969784625 0.896744375 0.97008425 0.9234385 0.9422605 0.9671403 0.9473576];
    XRBen=[0.1978575 0.3968035 0.750113625 0.354901 0.377145125 0.5168025 0.401335625 0.231610625];
    XRBhom=[0.8610129 0.9716942 0.9843339 0.9711338 0.926521625 0.9731342 0.9760012 0.923813625];
    XRBentr=[0.821580375 0.540378 0.21703269 0.577168375 0.6080187 0.379342625 0.50153025 0.781695375];
    XRBidm=[0.8601148 0.971691 0.9843326 0.9711306 0.926232875 0.9731342 0.9759347 0.92378225];
    XGBcon=[0.00385084375 0.0009941099 0.00123176625 0.0010515687 0.003002245 0.0010900045 0.000963395875 0.00201710375];
    XGBcor=[0.8001275 0.9696145 0.9222399 0.951072125 0.871254375 0.9455872 0.952039 0.9167616];
    XGBen=[0.4043528 0.4697235 0.550427875 0.49072175 0.4001285 0.507328125 0.55230325 0.384597625];
    XGBhom=[0.905682625 0.9756443 0.969821875 0.9742769 0.927565 0.9733455 0.97738125 0.950597625];
    XGBentr=[0.5008805 0.4439571 0.354921125 0.437637625 0.549971 0.3920752 0.380924 0.554595];
    XGBidm=[0.90567975 0.9756443 0.969821875 0.9742728 0.92745675 0.973340375 0.9772825 0.950596125];



result=0;
global_result=0;

for j1=1:m %цикл статистических испытаний
noise=randn(1,24);    
for j=1:8 %вычисление вектора-строки средних значений по столбцам матрицы эталонного описания      
    S1(j)=(Rcon(j)+Rcor(j)+Ren(j)+Rhom(j)+Gcon(j)+Gcor(j)+Gen(j)+Ghom(j)+Bcon(j)+Bcor(j)+Ben(j)+Bhom(j));
    S2(j)=(RGcon(j)+RGcor(j)+RGen(j)+RBhom(j)+RBcon(j)+RBcor(j)+RBen(j)+RBhom(j)+GBcon(j)+GBcor(j)+GBen(j)+GBhom(j));
    SJ(j)=(S1(j)+S2(j))/24;    
end; 
% SJ_contr=SJ(contr);
% for j=1:8 %вычисление матрицы параметров, полученных при моделирования результатов измерений
%    XRcon(j)=Rcon(j)+S*noise(1);XRcor(j)=Rcor(j)+S*noise(2);XRen(j)=Ren(j)+S*noise(3);XRhom(j)=Rhom(j)+S*noise(4);
%    XGcon(j)=Gcon(j)+S*noise(5);XGcor(j)=Gcor(j)+S*noise(6);XGen(j)=Gen(j)+S*noise(7);XGhom(j)=Ghom(j)+S*noise(8); 
%    XBcon(j)=Bcon(j)+S*noise(9);XBcor(j)=Bcor(j)+S*noise(10);XBen(j)=Ben(j)+S*noise(11);XBhom(j)=Bhom(j)+S*noise(12); 
%    XRGcon(j)=RGcon(j)+S*noise(13);XRGcor(j)=RGcor(j)+S*noise(14);XRGen(j)=RGen(j)+S*noise(15);XRGhom(j)=RGhom(j)+S*noise(16);
%    XRBcon(j)=RBcon(j)+S*noise(17);XRBcor(j)=RBcor(j)+S*noise(18);XRBen(j)=RBen(j)+S*noise(19);XRBhom(j)=RBhom(j)+S*noise(20);
%    XGBcon(j)=GBcon(j)+S*noise(21);XGBcor(j)=GBcor(j)+S*noise(22);XGBen(j)=GBen(j)+S*noise(23);XGBhom(j)=GBhom(j)+S*noise(24);   
% end  
for j=1:8 %вычисление вектора-строки средних значений по столбцам матрицы результатов измерений      
    XS1(j)=(XRcon(j)+XRcor(j)+XRen(j)+XRhom(j)+XGcon(j)+XGcor(j)+XGen(j)+XGhom(j)+XBcon(j)+XBcor(j)+XBen(j)+XBhom(j));   
    XS2(j)=(XRGcon(j)+XRGcor(j)+XRGen(j)+XRGhom(j)+XRBcon(j)+XRBcor(j)+XRBen(j)+XRBhom(j)+XGBcon(j)+XGBcor(j)+XGBen(j)+XGBhom(j));
    XSJ(j)=(XS1(j)+XS2(j))/24;   
end; 
% SJ_contr=SJ(k);
% XSJ_k=XSJ(contr);
       for j=1:8
          x_sko(j)=0;
          y_sko(j)=0;
       end    
 for j=1:8 %вектор-строка СКО по столбцам 
    x_sko1(j)= (Rcon(j)-SJ(j))*(Rcon(j)-SJ(j))+(Rcor(j)-SJ(j))*(Rcor(j)-SJ(j))+(Ren(j)-SJ(j))*(Ren(j)-SJ(j))+(Rhom(j)-SJ(j))*(Rhom(j)-SJ(j));
    x_sko2(j)= (Gcon(j)-SJ(j))*(Gcon(j)-SJ(j))+(Gcor(j)-SJ(j))*(Gcor(j)-SJ(j))+(Gen(j)-SJ(j))*(Gen(j)-SJ(j))+(Ghom(j)-SJ(j))*(Ghom(j)-SJ(j));
    x_sko3(j)= (Bcon(j)-SJ(j))*(Bcon(j)-SJ(j))+(Bcor(j)-SJ(j))*(Bcor(j)-SJ(j))+(Ben(j)-SJ(j))*(Ben(j)-SJ(j))+(Bhom(j)-SJ(j))*(Bhom(j)-SJ(j));
    x_sko4(j)= (RGcon(j)-SJ(j))*(RGcon(j)-SJ(j))+(RGcor(j)-SJ(j))*(RGcor(j)-SJ(j))+(RGen(j)-SJ(j))*(RGen(j)-SJ(j))+(RGhom(j)-SJ(j))*(RGhom(j)-SJ(j));
    x_sko5(j)= (RBcon(j)-SJ(j))*(RBcon(j)-SJ(j))+(RBcor(j)-SJ(j))*(RBcor(j)-SJ(j))+(RBen(j)-SJ(j))*(RBen(j)-SJ(j))+(RBhom(j)-SJ(j))*(RBhom(j)-SJ(j));   
    x_sko6(j)=(GBcon(j)-SJ(j))*(GBcon(j)-SJ(j))+(GBcor(j)-SJ(j))*(GBcor(j)-SJ(j))+(GBen(j)-SJ(j))*(GBen(j)-SJ(j))+(GBhom(j)-SJ(j))*(GBhom(j)-SJ(j));     
     x_sko(j)=x_sko1(j)+x_sko2(j)+x_sko3(j)+x_sko4(j)+x_sko5(j)+x_sko6(j);
    y_sko1(j)=(XRcon(j)-XSJ(j))*(XRcon(j)-XSJ(j))+(XRcor(j)-XSJ(j))*(XRcor(j)-XSJ(j))+(XRen(j)-XSJ(j))*(XRen(j)-XSJ(j))+(XRhom(j)-XSJ(j))*(XRhom(j)-XSJ(j));
    y_sko2(j)=(XGcon(j)-XSJ(j))*(XGcon(j)-XSJ(j))+(XGcor(j)-XSJ(j))*(XGcor(j)-XSJ(j))+(XGen(j)-XSJ(j))*(XGen(j)-XSJ(j))+(XGhom(j)-XSJ(j))*(XGhom(j)-XSJ(j));
    y_sko3(j)=(XBcon(j)-XSJ(j))*(XBcon(j)-XSJ(j))+(XBcor(j)-XSJ(j))*(XBcor(j)-XSJ(j))+(XBen(j)-XSJ(j))*(XBen(j)-XSJ(j))+(XBhom(j)-XSJ(j))*(XBhom(j)-XSJ(j));
    y_sko4(j)=(XRGcon(j)-XSJ(j))*(XRGcon(j)-XSJ(j))+(XRGcor(j)-XSJ(j))*(XRGcor(j)-XSJ(j))+(XRGen(j)-XSJ(j))*(XRGen(j)-XSJ(j))+(XRGhom(j)-XSJ(j))*(XRGhom(j)-XSJ(j));
    y_sko5(j)=(XRBcon(j)-XSJ(j))*(XRBcon(j)-XSJ(j))+(XRBcor(j)-XSJ(j))*(XRBcor(j)-XSJ(j))+(XRBen(j)-XSJ(j))*(XRBen(j)-XSJ(j))+(XRBhom(j)-XSJ(j))*(XRBhom(j)-XSJ(j));
    y_sko6(j)=(XGBcon(j)-XSJ(j))*(XGBcon(j)-XSJ(j))+(XGBcor(j)-XSJ(j))*(XGBcor(j)-XSJ(j))+(XGBen(j)-XSJ(j))*(XGBen(j)-XSJ(j))+(XGBhom(j)-XSJ(j))*(XGBhom(j)-XSJ(j));
    y_sko(j)= y_sko1(j)+y_sko2(j)+y_sko3(j)+y_sko4(j)+y_sko5(j)+y_sko6(j);
 end  
%  x_sko_contr= x_sko(contr);
%  y_sko_contr= y_sko(k);
%  z_sko_contr=sqrt(x_sko(contr)*y_sko(k));%%%%%%%%%%!!!!!!!!
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Вычисление вектора-столбца коэффициента ковариации выбранного вектора-столбца
%результатов измерений  с вектором-столбцом матрицы эталонного описания
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%RRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for j=1:8
Rcon_fp(j)=(Rcon(j)-SJ(j))*(XRcon(k)-XSJ(k));%функция принадлежности 1
Rcor_fp(j)=(Rcor(j)-SJ(j))*(XRcor(k)-XSJ(k));%функция принадлежности 2
Ren_fp(j)=(Ren(j)-SJ(j))*(XRen(k)-XSJ(k));%функция принадлежности 3
Rhom_fp(j)=(Rhom(j)-SJ(j))*(XRhom(k)-XSJ(k));%функция принадлежности 4
 SumR(j)=Rcon_fp(j)+Rcor_fp(j)+Ren_fp(j)+Rhom_fp(j);%коэф. ковариации по R
end 
SSumR=SumR
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for j=1:8
Gcon_fp(j)=(Gcon(j)-SJ(j))*(XGcon(k)-XSJ(k));%функция принадлежности 1
Gcor_fp(j)=(Gcor(j)-SJ(j))*(XGcor(k)-XSJ(k));%функция принадлежности 2
Gen_fp(j)=(Gen(j)-SJ(j))*(XGen(k)-XSJ(k));%функция принадлежности 3
Ghom_fp(j)=(Ghom(j)-SJ(j))*(XGhom(k)-XSJ(k));%функция принадлежности 4
    SumG(j)=Gcon_fp(j)+Gcor_fp(j)+Gen_fp(j)+Ghom_fp(j);%коэф. ковариации по G
end 
SSumG=SumG
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for j=1:8
Bcon_fp(j)=(Bcon(j)-SJ(j))*(XBcon(k)-XSJ(k));%функция принадлежности 1
Bcor_fp(j)=(Bcor(j)-SJ(j))*(XBcor(k)-XSJ(k));%функция принадлежности 2
Ben_fp(j)=(Ben(j)-SJ(j))*(XBen(k)-XSJ(k));%функция принадлежности 3
Bhom_fp(j)=(Bhom(j)-SJ(j))*(XBhom(k)-XSJ(k));%функция принадлежности 4
    SumB(j)=Bcon_fp(j)+Bcor_fp(j)+Ben_fp(j)+Bhom_fp(j);%коэф. ковариации по B
end 
SSumB=SumB
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%RG RG RG RG RG RG RG RG RG RG RG RG RG RG RG RG RG RG RG  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for j=1:8
RGcon_fp(j)=(RGcon(j)-SJ(j))*(XRGcon(k)-XSJ(k));%функция принадлежности 1
RGcor_fp(j)=(RGcor(j)-SJ(j))*(XRGcor(k)-XSJ(k));%функция принадлежности 2
RGen_fp(j)=(RGen(j)-SJ(j))*(XRGen(k)-XSJ(k));%функция принадлежности 3
RGhom_fp(j)=(RGhom(j)-SJ(j))*(XRGhom(k)-XSJ(k));%функция принадлежности 4
    SumRG(j)=RGcon_fp(j)+RGcor_fp(j)+RGen_fp(j)+RGhom_fp(j);%коэф. ковариации по RG
end 
SSumRG=SumRG
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%RB RB RB RB RB RB RB RB RB RB RB RB RB RB RB RB RB RB RB  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for j=1:8
RBcon_fp(j)=(RBcon(j)-SJ(j))*(XRBcon(k)-XSJ(k));%функция принадлежности 1
RBcor_fp(j)=(RBcor(j)-SJ(j))*(XRBcor(k)-XSJ(k));%функция принадлежности 2
RBen_fp(j)=(RBen(j)-SJ(j))*(XRBen(k)-XSJ(k));%функция принадлежности 3
RBhom_fp(j)=(RBhom(j)-SJ(j))*(XRBhom(k)-XSJ(k));%функция принадлежности 4   
    SumRB(j)=RBcon_fp(j)+RBcor_fp(j)+RBen_fp(j)+RBhom_fp(j);%коэф. ковариации по RB
end 
SSumRB=SumRB
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%GB GB GB GB GB GB GB GB GB GB GB GB GB GB GB GB GB GB GB GB GB GB 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for j=1:8  
GBcon_fp(j)=(GBcon(j)-SJ(j))*(XGBcon(k)-XSJ(k));%функция принадлежности 1
GBcor_fp(j)=(GBcor(j)-SJ(j))*(XGBcor(k)-XSJ(k));%функция принадлежности 2
GBen_fp(j)=(GBen(j)-SJ(j))*(XGBen(k)-XSJ(k));%функция принадлежности 3
GBhom_fp(j)=(GBhom(j)-SJ(j))*(XGBhom(k)-XSJ(k));%функция принадлежности 4  
    SumGB(j)=GBcon_fp(j)+GBcor_fp(j)+GBen_fp(j)+GBhom_fp(j);%коэф. ковариации по GB
end 
SSumGB=SumGB
for j=1:8
Sum(j)=SumR(j)+SumG(j)+SumB(j)+SumRG(j)+SumRB(j)+SumGB(j);
Sum1global(j)=Sum(j)/(sqrt(x_sko(j)*y_sko(k)));
%Sum1global(j)=Sum(j)
end
%SSum1global=Sum;
SSum1global=Sum1global
% if ((Sum1(j)>(1+BT)))  
%     Sum1(j)=0;
% else
% if ((Sum1(j)<(1-BT)))      
%      Sum1(j)=0; 
% end     
% end
%end
% SumMax=max(Sum(j));
% Sum_contr=Sum(contr)
% Sum1_contr=Sum1(contr)

% j=1:8; %функция принадлежности 
% figure
% plot(j,Sum1global(j));
% title('Sum1global');
  Sum1globalmax=max(SSum1global)
for i=1:8
    Voting_global(i)=0;
    if (Sum1global(i)==max(Sum1global));   
        Voting_global(i)=1;
    end    
end
% %end
 VotingGlobalRes=Voting_global%%%
kb_=0;
for i=1:8
    if (Voting_global(i)==1) 
       kb_= kb_+2^i ;
    end
end  
kb_in=kb_in;
kb_out=kb_ ;
if (kb_in==kb_out)   
  global_result=global_result+1;
end  
 end
GR=global_result;
GR_persent=GR/m*100; 

%pause;
close all;
clear;